You would think that he would have had a right to search since he clearly saw and smelled a car full of pot smoke. How else would a car fill up with smoke unless somebody was smoking in it? But he couldn't and what saved me was the decision to be firm and refuse search and it paid off in the end. 
